"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_extra_1 = require("fs-extra");
const path_1 = require("path");
const _defaultCopyStaticFiles = [
    ['.npmignore', 'file/npmignore'],
    ['.gitignore', 'file/gitignore'],
    ['.eslintignore', 'file/eslintignore'],
    ['.nvmrc', 'file/nvmrc'],
    ['.browserslistrc', 'file/browserslistrc'],
    ['tsconfig.json.tpl', 'file/tsconfig.json.tpl', 'tsconfig.json'],
    ['tsconfig.esm.json.tpl', 'file/tsconfig.esm.json.tpl', 'tsconfig.esm.json'],
    ['.eslintrc.json.tpl', 'file/eslintrc.json.tpl', '.eslintrc.json'],
    ['README.md', 'file/README.md'],
    ['.nycrc', 'file/nycrc'],
    ['.mocharc.yml', 'file/mocharc.yml'],
    ['jest.config.js', 'file/jest.config.js'],
    ['.nowignore', 'file/nowignore'],
    ['now.json.tpl', 'file/now.json.tpl', 'now.json'],
    ['lerna.json.tpl', 'file/lerna.json.tpl', 'lerna.json'],
];
exports.defaultCopyStaticFiles = Object.freeze(_defaultCopyStaticFiles);
function parseStaticMap(file_map) {
    let ls;
    if (Array.isArray(file_map)) {
        // @ts-ignore
        ls = Object.values(file_map);
    }
    else {
        // @ts-ignore
        ls = Object.entries(file_map);
    }
    return ls
        .filter(v => v && Array.isArray(v) && v.length > 1);
}
exports.parseStaticMap = parseStaticMap;
function getStaticFile(file_id, options) {
    let ls = parseStaticMap(options && options.file_map || exports.defaultCopyStaticFiles);
    return ls.find(([a]) => {
        return a === file_id;
    });
}
exports.getStaticFile = getStaticFile;
function copyStaticFiles(options) {
    if (!options.cwd || typeof options.cwd != 'string') {
        throw new TypeError(`options.cwd must is string`);
    }
    if (!fs_extra_1.pathExistsSync(options.cwd)) {
        throw new TypeError(`options.cwd not exists`);
    }
    let copyOptions = {
        overwrite: options.overwrite || false,
        preserveTimestamps: true,
        errorOnExist: false,
    };
    const { cwd, file_map = exports.defaultCopyStaticFiles } = options;
    const staticRoot = options.staticRoot || __dirname;
    let ls = parseStaticMap(file_map);
    ls = ls.filter(v => v && Array.isArray(v) && v.length > 1);
    if (!ls.length) {
        throw new TypeError(`file_map is not file map`);
    }
    return ls
        // @ts-ignore
        .filter(function ([a, b, c]) {
        let fa = path_1.resolve(cwd, a);
        let fb = path_1.resolve(staticRoot, b);
        if (c != null) {
            let fc = path_1.resolve(cwd, c);
            if (fs_extra_1.existsSync(fc)) {
                return;
            }
        }
        if (!fs_extra_1.existsSync(fb)) {
            throw new Error(`file not exists. ${fb}`);
        }
        fs_extra_1.copySync(fb, fa, copyOptions);
        return true;
    });
}
exports.copyStaticFiles = copyStaticFiles;
exports.default = copyStaticFiles;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVDQUFpRjtBQUNqRiwrQkFBK0I7QUFFL0IsTUFBTSx1QkFBdUIsR0FBRztJQUUvQixDQUFDLFlBQVksRUFBRSxnQkFBZ0IsQ0FBQztJQUNoQyxDQUFDLFlBQVksRUFBRSxnQkFBZ0IsQ0FBQztJQUVoQyxDQUFDLGVBQWUsRUFBRSxtQkFBbUIsQ0FBQztJQUV0QyxDQUFDLFFBQVEsRUFBRSxZQUFZLENBQUM7SUFDeEIsQ0FBQyxpQkFBaUIsRUFBRSxxQkFBcUIsQ0FBQztJQUUxQyxDQUFDLG1CQUFtQixFQUFFLHdCQUF3QixFQUFFLGVBQWUsQ0FBQztJQUNoRSxDQUFDLHVCQUF1QixFQUFFLDRCQUE0QixFQUFFLG1CQUFtQixDQUFDO0lBRTVFLENBQUMsb0JBQW9CLEVBQUUsd0JBQXdCLEVBQUUsZ0JBQWdCLENBQUM7SUFFbEUsQ0FBQyxXQUFXLEVBQUUsZ0JBQWdCLENBQUM7SUFFL0IsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDO0lBRXhCLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDO0lBQ3BDLENBQUMsZ0JBQWdCLEVBQUUscUJBQXFCLENBQUM7SUFFekMsQ0FBQyxZQUFZLEVBQUUsZ0JBQWdCLENBQUM7SUFFaEMsQ0FBQyxjQUFjLEVBQUUsbUJBQW1CLEVBQUUsVUFBVSxDQUFDO0lBRWpELENBQUMsZ0JBQWdCLEVBQUUscUJBQXFCLEVBQUUsWUFBWSxDQUFDO0NBRTlDLENBQUM7QUEwQkUsUUFBQSxzQkFBc0IsR0FBeUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBUSxDQUFDO0FBaUIxSCxTQUFnQixjQUFjLENBQW1CLFFBQXlCO0lBRXpFLElBQUksRUFBd0IsQ0FBQztJQUU3QixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQzNCO1FBQ0MsYUFBYTtRQUNiLEVBQUUsR0FBRyxNQUFN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ekRELDBDQXlEQztBQUVELGtCQUFlLGVBQWUsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMsIGNvcHlTeW5jLCBDb3B5T3B0aW9uc1N5bmMsIHBhdGhFeGlzdHNTeW5jIH0gZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHsgcmVzb2x2ZSB9IGZyb20gJ3BhdGgnO1xuXG5jb25zdCBfZGVmYXVsdENvcHlTdGF0aWNGaWxlcyA9IFtcblxuXHRbJy5ucG1pZ25vcmUnLCAnZmlsZS9ucG1pZ25vcmUnXSxcblx0WycuZ2l0aWdub3JlJywgJ2ZpbGUvZ2l0aWdub3JlJ10sXG5cblx0WycuZXNsaW50aWdub3JlJywgJ2ZpbGUvZXNsaW50aWdub3JlJ10sXG5cblx0WycubnZtcmMnLCAnZmlsZS9udm1yYyddLFxuXHRbJy5icm93c2Vyc2xpc3RyYycsICdmaWxlL2Jyb3dzZXJzbGlzdHJjJ10sXG5cblx0Wyd0c2NvbmZpZy5qc29uLnRwbCcsICdmaWxlL3RzY29uZmlnLmpzb24udHBsJywgJ3RzY29uZmlnLmpzb24nXSxcblx0Wyd0c2NvbmZpZy5lc20uanNvbi50cGwnLCAnZmlsZS90c2NvbmZpZy5lc20uanNvbi50cGwnLCAndHNjb25maWcuZXNtLmpzb24nXSxcblxuXHRbJy5lc2xpbnRyYy5qc29uLnRwbCcsICdmaWxlL2VzbGludHJjLmpzb24udHBsJywgJy5lc2xpbnRyYy5qc29uJ10sXG5cblx0WydSRUFETUUubWQnLCAnZmlsZS9SRUFETUUubWQnXSxcblxuXHRbJy5ueWNyYycsICdmaWxlL255Y3JjJ10sXG5cblx0WycubW9jaGFyYy55bWwnLCAnZmlsZS9tb2NoYXJjLnltbCddLFxuXHRbJ2plc3QuY29uZmlnLmpzJywgJ2ZpbGUvamVzdC5jb25maWcuanMnXSxcblxuXHRbJy5ub3dpZ25vcmUnLCAnZmlsZS9ub3dpZ25vcmUnXSxcblxuXHRbJ25vdy5qc29uLnRwbCcsICdmaWxlL25vdy5qc29uLnRwbCcsICdub3cuanNvbiddLFxuXG5cdFsnbGVybmEuanNvbi50cGwnLCAnZmlsZS9sZXJuYS5qc29uLnRwbCcsICdsZXJuYS5qc29uJ10sXG5cbl0gYXMgY29uc3Q7XG5cbmV4cG9ydCB0eXBlIElTdGF0aWNGaWxlc0lEPFQgPSB0eXBlb2YgX2RlZmF1bHRDb3B5U3RhdGljRmlsZXM+ID1cblx0VCBleHRlbmRzICh7XG5cdFx0W246IG51bWJlcl06IFtpbmZlciBVLCBzdHJpbmcsIHN0cmluZz9dIHwgcmVhZG9ubHkgW2luZmVyIFUsIHN0cmluZywgc3RyaW5nP107XG5cdH0gfCB7XG5cdFx0cmVhZG9ubHkgW246IG51bWJlcl06IFtpbmZlciBVLCBzdHJpbmcsIHN0cmluZz9dIHwgcmVhZG9ubHkgW2luZmVyIFUsIHN0cmluZywgc3RyaW5nP107XG5cdH0pXG5cdD8gVVxuXHQ6IG5ldmVyXG5cdDtcblxuZXhwb3J0IHR5cGUgSVN0YXRpY0ZpbGVzUm93PEsgZXh0ZW5kcyBzdHJpbmc+ID0gW0ssIHN0cmluZywgc3RyaW5nP11cblxudHlwZSBJU3RhdGljRmlsZXNNYXAwMTxLIGV4dGVuZHMgc3RyaW5nPiA9IHtcblx0W1AgaW4gS106IElTdGF0aWNGaWxlc1JvdzxQPlxufVxuXG5leHBvcnQgdHlwZSBJU3RhdGljRmlsZXNNYXBSZWNvcmQ8SyBleHRlbmRzIHN0cmluZz4gPSB7XG5cdFtQIGluIEtdOiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgSVN0YXRpY0ZpbGVzTWFwQXJyYXk8SyBleHRlbmRzIHN0cmluZz4gPSBJU3RhdGljRmlsZXNNYXAwMTxLPltLXVtdXG5cbmV4cG9ydCB0eXBlIElTdGF0aWNGaWxlczxLIGV4dGVuZHMgc3RyaW5nPiA9IElTdGF0aWNGaWxlc01hcEFycmF5PEs+IHwgSVN0YXRpY0ZpbGVzTWFwUmVjb3JkPEs+XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0Q29weVN0YXRpY0ZpbGVzOiBJU3RhdGljRmlsZXNNYXBBcnJheTxJU3RhdGljRmlsZXNJRD4gPSBPYmplY3QuZnJlZXplKF9kZWZhdWx0Q29weVN0YXRpY0ZpbGVzKSBhcyBhbnk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNvcHlTdGF0aWNGaWxlc09wdGlvbnNCYXNlPEsgZXh0ZW5kcyBzdHJpbmcgPSBzdHJpbmc+XG57XG5cdGN3ZDogc3RyaW5nLFxuXHRzdGF0aWNSb290Pzogc3RyaW5nLFxuXHRvdmVyd3JpdGU/OiBib29sZWFuLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDb3B5U3RhdGljRmlsZXNPcHRpb25zPEsgZXh0ZW5kcyBzdHJpbmcgPSBzdHJpbmc+IGV4dGVuZHMgSUNvcHlTdGF0aWNGaWxlc09wdGlvbnNCYXNlPEs+XG57XG5cdGZpbGVfbWFwPzogSVN0YXRpY0ZpbGVzPEs+LFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTdGF0aWNNYXA8SyBleHRlbmRzIHN0cmluZz4oZmlsZV9tYXA6IElTdGF0aWNGaWxlc01hcFJlY29yZDxLPik6IFtLIHwgSVN0YXRpY0ZpbGVzSUQsIHN0cmluZywgc3RyaW5nP11bXVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlU3RhdGljTWFwPEsgZXh0ZW5kcyBzdHJpbmc+KGZpbGVfbWFwOiBJU3RhdGljRmlsZXNNYXBBcnJheTxLPik6IFtLIHwgSVN0YXRpY0ZpbGVzSUQsIHN0cmluZywgc3RyaW5nP11bXVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlU3RhdGljTWFwPEsgZXh0ZW5kcyBzdHJpbmc+KGZpbGVfbWFwOiBJU3RhdGljRmlsZXM8Sz4pOiBbSyB8IElTdGF0aWNGaWxlc0lELCBzdHJpbmcsIHN0cmluZz9dW11cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVN0YXRpY01hcDxLIGV4dGVuZHMgc3RyaW5nPihmaWxlX21hcDogSVN0YXRpY0ZpbGVzPEs+KTogW0ssIHN0cmluZywgc3RyaW5nP11bXVxue1xuXHRsZXQgbHM6IElTdGF0aWNGaWxlc1JvdzxLPltdO1xuXG5cdGlmIChBcnJheS5pc0FycmF5KGZpbGVfbWFwKSlcblx0e1xuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRscyA9IE9iamVjdC52YWx1ZXMoZmlsZV9tYXApXG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdGxzID0gT2JqZWN0LmVudHJpZXMoZmlsZV9tYXApXG5cdH1cblxuXHRyZXR1cm4gbHNcblx0XHQuZmlsdGVyKHYgPT4gdiAmJiBBcnJheS5pc0FycmF5KHYpICYmIHYubGVuZ3RoID4gMSlcblx0XHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdGF0aWNGaWxlPEsgZXh0ZW5kcyBzdHJpbmc+KGZpbGVfaWQ6IEssIG9wdGlvbnM/OiBQaWNrPElDb3B5U3RhdGljRmlsZXNPcHRpb25zPHN0cmluZz4sICdmaWxlX21hcCc+KTogW0ssIHN0cmluZywgc3RyaW5nP11cbntcblx0bGV0IGxzID0gcGFyc2VTdGF0aWNNYXAob3B0aW9ucyAmJiBvcHRpb25zLmZpbGVfbWFwIHx8IGRlZmF1bHRDb3B5U3RhdGljRmlsZXMgYXMgSVN0YXRpY0ZpbGVzTWFwQXJyYXk8Sz4pO1xuXG5cdHJldHVybiBscy5maW5kKChbYV0pID0+IHtcblx0XHRyZXR1cm4gYSA9PT0gZmlsZV9pZDtcblx0fSkgYXMgW0ssIHN0cmluZywgc3RyaW5nP11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlTdGF0aWNGaWxlczxLIGV4dGVuZHMgc3RyaW5nPihvcHRpb25zOiBJQ29weVN0YXRpY0ZpbGVzT3B0aW9uczxLPilcbntcblx0aWYgKCFvcHRpb25zLmN3ZCB8fCB0eXBlb2Ygb3B0aW9ucy5jd2QgIT0gJ3N0cmluZycpXG5cdHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKGBvcHRpb25zLmN3ZCBtdXN0IGlzIHN0cmluZ2ApXG5cdH1cblxuXHRpZiAoIXBhdGhFeGlzdHNTeW5jKG9wdGlvbnMuY3dkKSlcblx0e1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYG9wdGlvbnMuY3dkIG5vdCBleGlzdHNgKVxuXHR9XG5cblx0bGV0IGNvcHlPcHRpb25zOiBDb3B5T3B0aW9uc1N5bmMgPSB7XG5cdFx0b3ZlcndyaXRlOiBvcHRpb25zLm92ZXJ3cml0ZSB8fCBmYWxzZSxcblx0XHRwcmVzZXJ2ZVRpbWVzdGFtcHM6IHRydWUsXG5cdFx0ZXJyb3JPbkV4aXN0OiBmYWxzZSxcblx0fTtcblxuXHRjb25zdCB7IGN3ZCwgZmlsZV9tYXAgPSBkZWZhdWx0Q29weVN0YXRpY0ZpbGVzIGFzIElTdGF0aWNGaWxlc01hcEFycmF5PEs+IH0gPSBvcHRpb25zO1xuXHRjb25zdCBzdGF0aWNSb290ID0gb3B0aW9ucy5zdGF0aWNSb290IHx8IF9fZGlybmFtZTtcblxuXHRsZXQgbHMgPSBwYXJzZVN0YXRpY01hcDxLPihmaWxlX21hcCk7XG5cblx0bHMgPSBscy5maWx0ZXIodiA9PiB2ICYmIEFycmF5LmlzQXJyYXkodikgJiYgdi5sZW5ndGggPiAxKTtcblxuXHRpZiAoIWxzLmxlbmd0aClcblx0e1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYGZpbGVfbWFwIGlzIG5vdCBmaWxlIG1hcGApXG5cdH1cblxuXHRyZXR1cm4gbHNcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0LmZpbHRlcihmdW5jdGlvbiAoW2EsIGIsIGNdOiBJU3RhdGljRmlsZXNSb3c8Sz4pXG5cdFx0e1xuXHRcdFx0bGV0IGZhID0gcmVzb2x2ZShjd2QsIGEpO1xuXHRcdFx0bGV0IGZiID0gcmVzb2x2ZShzdGF0aWNSb290LCBiKTtcblxuXHRcdFx0aWYgKGMgIT0gbnVsbClcblx0XHRcdHtcblx0XHRcdFx0bGV0IGZjID0gcmVzb2x2ZShjd2QsIGMpO1xuXG5cdFx0XHRcdGlmIChleGlzdHNTeW5jKGZjKSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIWV4aXN0c1N5bmMoZmIpKVxuXHRcdFx0e1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYGZpbGUgbm90IGV4aXN0cy4gJHtmYn1gKVxuXHRcdFx0fVxuXG5cdFx0XHRjb3B5U3luYyhmYiwgZmEsIGNvcHlPcHRpb25zKTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSlcblx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBjb3B5U3RhdGljRmlsZXNcbiJdfQ==